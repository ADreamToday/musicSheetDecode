C251 COMPILER V5.60.0,  main                                                               08/04/23  16:40:08  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE main
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C251\BIN\C251.EXE main.c INTR2 BROWSE DEBUG PRINT(.\Listings\main.lst) TABS(2) OBJECT(.\
                    -Objects\main.obj) 

stmt  level    source

    1          #include <STC32G.h>
    2          #include <intrins.h>
    3          #define u8 unsigned char
    4          
    5          // IRC = 24Mhz
    6          
    7          u8 Timer0H = 0x00;
    8          u8 Timer0L = 0x00;
    9          
   10          u8 code soundTrack[][] = { {0xf9,0x57} , {0xfb,0x03} , {0xfb,0x8f} , {0xfc,0x0a} , {0xfb,0x8f} , {0xfb,0x
             -03} , {0xfa,0x12} , {0xfb,0x03} , {0xfb,0x03} , {0xf9,0x57} , {0xfb,0x03} , {0xfb,0x8f} , {0xfc,0x0a} , {0xfb,0x8f} , {0
             -xfb,0x03} , {0xfa,0x12} , {0xfb,0x03} , {0xfb,0x03} , {0xfb,0x03} , {0xfc,0xab} , {0xfc,0xab} , {0xfc,0x0a} , {0xfc,0x0a
             -} , {0xfb,0x8f} , {0xfb,0x03} , {0xfb,0x8f} , {0xfc,0xab} , {0xfc,0xab} , {0xfc,0x0a} , {0xfb,0x8f} , {0xfb,0x03} , {0xf
             -c,0x43} , {0xfc,0x0a} , {0xf9,0x57} , {0xfb,0x03} , {0xfb,0x8f} , {0xfc,0x0a} , {0xfb,0x8f} , {0xfb,0x03} , {0xfa,0x12} 
             -, {0xfb,0x03} , {0xfb,0x03} , {0xfb,0x03} , {0xf9,0x57} , {0xfb,0x03} , {0xfb,0x8f} , {0xfc,0x0a} , {0xfb,0x8f} , {0xfb,
             -0x03} , {0xfa,0x12} , {0xfb,0x03} , {0xfb,0x03} , {0xf9,0x57} , {0xfb,0x03} , {0xfb,0x8f} , {0xfc,0x0a} , {0xfb,0x8f} , 
             -{0xfb,0x03} , {0xfa,0x12} , {0xfb,0x03} , {0xfb,0x03} , {0xfb,0x03} , {0xfc,0xab} , {0xfc,0xab} , {0xfc,0x0a} , {0xfc,0x
             -0a} , {0xfb,0x8f} , {0xfb,0x03} , {0xfb,0x8f} , {0xfc,0xab} , {0xfc,0xab} , {0xfc,0x0a} , {0xfc,0x0a} , {0xfb,0x8f} , {0
             -xfb,0x03} , {0xfc,0x43} , {0xfc,0x0a} , {0xf9,0x57} , {0xfb,0x03} , {0xfb,0x8f} , {0xfc,0x0a} , {0xfb,0x8f} , {0xfb,0x03
             -} , {0xfa,0x12} , {0xfb,0x03} , {0xfb,0x03} , {0xfb,0x03} , };
   11          float code time[] = { 1.500000 , 0.500000 , 0.500000 , 1.500000 , 1.500000 , 0.500000 , 0.500000 , 0.5000
             -00 , 8.000000 , 1.500000 , 0.500000 , 0.500000 , 1.500000 , 1.500000 , 0.500000 , 0.500000 , 0.500000 , 4.000000 , 3.000
             -000 , 1.000000 , 1.500000 , 0.500000 , 0.250000 , 0.250000 , 1.500000 , 3.000000 , 1.000000 , 1.500000 , 0.500000 , 0.50
             -0000 , 1.500000 , 3.000000 , 1.000000 , 1.500000 , 0.500000 , 0.500000 , 1.500000 , 1.000000 , 1.000000 , 1.000000 , 1.0
             -00000 , 4.000000 , 4.000000 , 1.500000 , 0.500000 , 0.500000 , 1.500000 , 1.000000 , 1.000000 , 1.000000 , 1.000000 , 8.
             -000000 , 1.500000 , 0.500000 , 0.500000 , 1.500000 , 1.000000 , 1.000000 , 1.000000 , 1.000000 , 4.000000 , 3.000000 , 1
             -.000000 , 1.500000 , 0.500000 , 0.250000 , 0.250000 , 1.500000 , 3.000000 , 1.000000 , 1.500000 , 0.500000 , 0.250000 , 
             -0.250000 , 1.500000 , 3.000000 , 1.000000 , 1.500000 , 0.500000 , 0.500000 , 1.500000 , 1.000000 , 1.000000 , 1.000000 ,
             - 1.000000 , 4.000000 , 4.000000 , };
   12          int length = 87;
   13          int speed = 92; // 120个音符代码每分钟
   14            
   15            
   16          int Interrupttimes = 0;
   17          
   18          void write()
   19          {
   20   1        P00 = !P00;
   21   1      }
   22          
   23          void T0() interrupt 1
   24          {
   25   1        write();
   26   1      }
   27          
   28          void T1() interrupt 3
   29          {
   30   1        Interrupttimes++;
   31   1      }
   32          
   33          
   34          void main()
   35          {
   36   1        int i = 0;
   37   1        
   38   1        int singleTime = 0;
   39   1      
   40   1        //24MHz = 20*10^6hz
C251 COMPILER V5.60.0,  main                                                               08/04/23  16:40:08  PAGE 2   

   41   1        EAXFR = 1;
   42   1        WTST = 0x00;
   43   1        
   44   1        P0M0 = 0x00;
   45   1        P0M1 = 0x00;
   46   1        P1M0 = 0x00;
   47   1        P1M1 = 0x00;
   48   1        P2M0 = 0x00;
   49   1        P2M1 = 0x00;
   50   1        P3M0 = 0x00;
   51   1        P3M1 = 0x00;
   52   1        P4M0 = 0x00;
   53   1        P4M1 = 0x00;
   54   1        P5M0 = 0x00;
   55   1        P5M1 = 0x00;
   56   1        P6M0 = 0x00;
   57   1        P6M1 = 0x00;
   58   1        P7M0 = 0x00;
   59   1        P7M1 = 0x00;
   60   1        
   61   1        TMOD = 0x00;
   62   1        
   63   1        TL0 = 0x00; 
   64   1        TH0 = 0x00;   
   65   1        TL1 = 0xef; // 5ms一次中断
   66   1        TH1 = 0xd8;
   67   1        
   68   1        TR1 = 1;
   69   1        ET1 = 1;
   70   1        
   71   1        TR0 = 1;        //start timer0
   72   1        ET0 = 1;        //允许中断
   73   1        
   74   1        EA = 1;
   75   1        
   76   1        P00 = 0;
   77   1        P10 = 0;
   78   1        
   79   1        {
   80   2          for (i = 0 ; i < length ; i++) // 读取
   81   2          {
   82   3            P10 = 0;
   83   3            // 更改t0高低八位
   84   3            Timer0H = soundTrack[i][0];
   85   3            Timer0L = soundTrack[i][1];
   86   3            singleTime = (12000 / speed) * time[i];
   87   3            Interrupttimes = 0;
   88   3            
   89   3            if (Timer0H == 0xff && Timer0L == 0xff)
   90   3            {
   91   4              while(singleTime > Interrupttimes)
   92   4              {
   93   5                ET0 = 0;        //允许中断
   94   5              }
   95   4              ET0 = 1;        //允许中断
   96   4            }
   97   3            else
   98   3            {
   99   4              TH0 = Timer0H;
  100   4              TL0 = Timer0L;
  101   4              // 判断时间到没到
  102   4              while(singleTime > Interrupttimes)
  103   4              {
  104   5                P10 = 1;
  105   5              }
  106   4            }
C251 COMPILER V5.60.0,  main                                                               08/04/23  16:40:08  PAGE 3   

  107   3            
  108   3            
  109   3            // 停顿一下
  110   3            singleTime = 4;
  111   3            Interrupttimes = 0;
  112   3            while(singleTime > Interrupttimes)
  113   3            {
  114   4              ET0 = 0;        //不允许中断
  115   4            } 
  116   3            ET0 = 1;        //允许中断
  117   3          }
  118   2          
  119   2          // stop
  120   2          ET0 = 0;
  121   2          ET1 = 0;
  122   2          while(1){}
  123   2        }
  124   1        
  125   1        
  126   1      }


Module Information          Static   Overlayable
------------------------------------------------
  code size            =       847     ------
  ecode size           =    ------     ------
  data size            =         8     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =    ------     ------
  xdata-const size     =    ------     ------
  edata size           =    ------     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =    ------     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
